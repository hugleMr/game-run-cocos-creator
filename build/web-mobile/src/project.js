window.__require=function t(e,n,i){function o(c,a){if(!n[c]){if(!e[c]){var u=c.split("/");if(u=u[u.length-1],!e[u]){var r="function"==typeof __require&&__require;if(!a&&r)return r(u,!0);if(s)return s(u,!0);throw new Error("Cannot find module '"+c+"'")}}var d=n[c]={exports:{}};e[c][0].call(d.exports,function(t){return o(e[c][1][t]||t)},d,d.exports,t,e,n,i)}return n[c].exports}for(var s="function"==typeof __require&&__require,c=0;c<i.length;c++)o(i[c]);return o}({CameraFollow:[function(t,e,n){"use strict";cc._RF.push(e,"1b234WfskxPMbvOkn4r09st","CameraFollow"),cc.Class({extends:cc.Component,properties:{target:{default:null,type:cc.Node},offset:0},start:function(){},update:function(t){this.node.x=this.target.x+this.offset}}),cc._RF.pop()},{}],Config:[function(t,e,n){"use strict";cc._RF.push(e,"952a4sZQVlEiZ8kdHK2lCKu","Config"),Object.defineProperty(n,"__esModule",{value:!0});n.instance={WIDTH_TILE:235,HEIGHT_MAX:100,hero:{default:null,type:t("Hero")},game:{default:null,type:t("GameControl")},ground:{default:null,type:t("Ground")},isPlay:!1,speed:300};cc._RF.pop()},{GameControl:"GameControl",Ground:"Ground",Hero:"Hero"}],GameControl:[function(t,e,n){"use strict";cc._RF.push(e,"b13e597esVIBJsVRReYHGhi","GameControl");var i=t("Config");cc.Class({extends:cc.Component,properties:{groundPrefab:{default:null,type:cc.Prefab},groundRoot:{default:null,type:cc.Node},startGround:{default:null,type:cc.Node},uiStart:{default:null,type:cc.Node},initSpeed:300,speedDamping:50,speedMax:1500,speedlabel:{default:null,type:cc.Label}},onLoad:function(){cc.director.getPhysicsManager().enabled=!0,i.instance.game=this},start:function(){},onStartGame:function(){for(var t in null!=this.startGround&&(this.startGround.destroy(),this.startGround=null),this.uiStart.active=!1,i.instance.speed=this.initSpeed,i.instance.hero.init(),i.instance.isPlay=!0,this.groundActive)this.groundActive[t].destroy();this.groundActive=new Array,this.spawnFistGround(),this.spawnNextGround(),this.spawnNextGround(),this.spawnNextGround()},spawnFistGround:function(){this.groundRoot.setPosition(new cc.v2(0,0)),this.pos=-700,this.spawnGround(0,5*i.instance.WIDTH_TILE,0)},spawnNextGround:function(){var t=Math.random()*i.instance.HEIGHT_MAX,e=this.getMaxDistance(),n=Math.random()*(e-200)+200,o=0;o=t>this.oldHeight?e-(n-=t-this.oldHeight):e-n+this.oldHeight-t,o=Math.max(o,i.instance.WIDTH_TILE);var s=e-n+600,c=Math.random()*(s-o)+o;c=Math.round(c/i.instance.WIDTH_TILE)*i.instance.WIDTH_TILE,this.spawnGround(n,c,t)},spawnGround:function(t,e,n){this.pos+=t+e/2;var i=cc.instantiate(this.groundPrefab);i.parent=this.groundRoot,i.getComponent("Ground").init(e,this.pos,n),this.groundActive.push(i),this.pos+=e/2,this.oldHeight=n,console.log("spawn ground: "),console.log(i)},getMaxDistance:function(){return i.instance.speed*i.instance.hero.jumpTime},despawnGround:function(t){this.groundActive.shift(),t.destroy(),this.spawnNextGround()},update:function(t){1==i.instance.isPlay&&(this.groundActive[0].x+this.groundActive[0].getComponent("Ground").width+700<i.instance.hero.node.x&&this.despawnGround(this.groundActive[0]),i.instance.speed<this.speedMax&&(i.instance.speed+=this.speedDamping*t,this.speedlabel.string="Speed: "+i.instance.speed.toFixed(0)))},gameOver:function(){i.instance.isPlay=!1,this.uiStart.active=!0}}),cc._RF.pop()},{Config:"Config"}],Ground:[function(t,e,n){"use strict";cc._RF.push(e,"d36ddccB2BMDZ3YEO/1ZdQn","Ground");t("Config");cc.Class({extends:cc.Component,properties:{spriteNode:{default:null,type:cc.Node},collider:{default:null,type:cc.PhysicsBoxCollider}},init:function(t,e,n){this.width=t,this.spriteNode.width=t,this.collider.size.width=t,console.log(this.collider),this.node.setPosition(new cc.v2(e,n)),this.node.active=!0},hide:function(){},onLoad:function(){},start:function(){},update:function(t){}}),cc._RF.pop()},{Config:"Config"}],Hero:[function(t,e,n){"use strict";cc._RF.push(e,"b89602kuiNEHqJiDFFV8qBN","Hero");var i=t("Config"),o=cc.Enum({Idel:-1,Dead:-1,Drop:-1,Jump:-1,Run:-1});cc.Class({extends:cc.Component,properties:{jumpSpeed:900,jumpSpeedBonus:500,canvas:{default:null,type:cc.Node},state:{get:function(){return this._state},set:function(t){t!==this._state&&(this._state=t,this._state!==o.None&&this._updateAnimation())},type:o},jumpAudio:{default:null,type:cc.AudioClip},diedAudio:{default:null,type:cc.AudioClip}},_updateAnimation:function(){var t=o[this._state];this.anim.stop(),this.anim.play(t)},start:function(){},update:function(t){i.instance.isPlay&&(this.node.x+=i.instance.speed*t,this.node.y<-400&&(i.instance.game.gameOver(),cc.audioEngine.playEffect(this.diedAudio)),this.state==o.Jump&&this.rigidbody.linearVelocity.y<0&&(this.state=o.Drop))},init:function(){this.node.position=new cc.Vec2(0,0),this.rigidbody.linearVelocity=new cc.Vec2(0,0),this.state=o.Run},onLoad:function(){this.canvas.on(cc.Node.EventType.TOUCH_START,this.jumpClick,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.rigidbody=this.node.getComponent(cc.RigidBody),this.anim=this.node.getComponent(cc.Animation),this.speed=0,this.bonusJump=0,this.cacheJump=!1,this.state=o.Idel,i.instance.hero=this,this.jumpTime=1.7},jumpClick:function(t){this.state==o.Jump&&this.state==o.Drop||0!=this.rigidbody.linearVelocity.y.toFixed(3)?0==this.bonusJump&&this.rigidbody.linearVelocity.y<0?(this.bonusJump++,this.rigidbody.linearVelocity=new cc.Vec2(0,this.jumpSpeedBonus),this.state=o.Jump,cc.audioEngine.playEffect(this.jumpAudio)):this.rigidbody.linearVelocity.y<0&&(this.cacheJump=!0):this.onJump()},onJump:function(){this.cacheJump=!1,this.bonusJump=0,this.rigidbody.linearVelocity=new cc.Vec2(0,this.jumpSpeed),this.state=o.Jump,cc.audioEngine.playEffect(this.jumpAudio)},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.space:this.jumpClick(t)}},onBeginContact:function(t,e,n){switch(n.node.group){case"enemy":i.instance.isPlay=!1,this.state=o.Dead;break;case"ground":this.cacheJump?this.onJump():this.state=o.Run}}}),cc._RF.pop()},{Config:"Config"}],Scroller:[function(t,e,n){"use strict";cc._RF.push(e,"f5bacFvg71Fd78Tw4GD9Lc6","Scroller");var i=t("Config");cc.Class({extends:cc.Component,properties:{speed:0,resetX:0},update:function(t){if(0!=i.instance.isPlay){var e=this.node.x;(e+=this.speed*t)<=this.resetX&&(e-=this.resetX),this.node.x=e}}}),cc._RF.pop()},{Config:"Config"}]},{},["CameraFollow","Config","GameControl","Ground","Hero","Scroller"]);